typeset -U PATH path

if [ -x "/usr/bin/npm" ]; then
    node_modules="$PATH:$HOME/.local/lib/node_modules/bin:$PAH"
fi

path=("$HOME/.local/bin" "$GOPATH" "$node_modules" "$dart" "$cabal" "$HOME/.local/share/cargo/bin" "$path[@]")

export PATH

# Colorful Man Pages
export PAGER=less
export BAT_PAGER="less -RFXi"

# XDG directories
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CACHE_HOME="$HOME/.cache"
export XDG_DATA_HOME="$HOME/.local/share"

export EDITOR=nvim
export VISUAL=code-oss
export GTK_USE_PORTAL=1

export MANPAGER="sh -c 'col -bx | bat -l man -p'"

export GPG_TTY=$(tty)

# Set XDG Base Directories
# Atom
export ATOM_HOME=$XDG_CONFIG_HOME/atom

# AWS
export AWS_SHARED_CREDENTIALS_FILE="$XDG_CONFIG_HOME"/aws/credentials
export AWS_CONFIG_FILE="$XDG_CONFIG_HOME"/aws/config

# Azure
export AZURE_CONFIG_DIR=$XDG_DATA_HOME/azure

# Bazaar
export BZRPATH=$XDG_CONFIG_HOME/bazaar
export BZR_PLUGIN_PATH=$XDG_DATA_HOME/bazaar
export BZR_HOME=$XDG_CACHE_HOME/bazaar

# Bundle (Ruby)
export BUNDLE_USER_CONFIG="$XDG_CONFIG_HOME"/bundle BUNDLE_USER_CACHE="$XDG_CACHE_HOME"/bundle BUNDLE_USER_PLUGIN="$XDG_DATA_HOME"/bundle

# Cargo
export CARGO_HOME="$XDG_DATA_HOME"/cargo 

# CCache
export CCACHE_CONFIGPATH="$XDG_CONFIG_HOME"/ccache.config
export CCACHE_DIR="$XDG_CACHE_HOME"/ccache

# Docker
export DOCKER_CONFIG="$XDG_CONFIG_HOME"/docker
export MACHINE_STORAGE_PATH="$XDG_DATA_HOME"/docker-machine

# GO
export GOPATH="$HOME/.local/share/go"

# GPG
export GNUPGHOME="$XDG_DATA_HOME"/gnupg

# Gems (Ruby)
export GEM_HOME="$XDG_DATA_HOME"/gem
export GEM_SPEC_CACHE="$XDG_CACHE_HOME"/gem

# Lastpass
export LPASS_HOME=$XDG_CONFIG_HOME/lpass

# Less
export LESSKEY="$XDG_CONFIG_HOME"/less/lesskey
export LESSHISTFILE="$XDG_CACHE_HOME"/less/history

# Most
export MOST_INITFILE="$XDG_CONFIG_HOME"/mostrc

# MPlayer
export MPLAYER_HOME=$XDG_CONFIG_HOME/mplayer

# MySQL
export MYSQL_HISTFILE="$XDG_DATA_HOME"/mysql_history

# Ncurses
export TERMINFO="$XDG_DATA_HOME"/terminfo
export TERMINFO_DIRS="$XDG_DATA_HOME"/terminfo:/usr/share/terminfo

# Node
export NODE_REPL_HISTORY="$XDG_DATA_HOME"/node_repl_history

# NPM
export NPM_CONFIG_USERCONFIG=$XDG_CONFIG_HOME/npm/npmrc

# NVM
export NVM_DIR="$XDG_DATA_HOME"/nvm

# PostgreSQL
export PSQLRC="$XDG_CONFIG_HOME/pg/psqlrc"
export PSQL_HISTORY="$XDG_CACHE_HOME/pg/psql_history"
export PGPASSFILE="$XDG_CONFIG_HOME/pg/pgpass"
export PGSERVICEFILE="$XDG_CONFIG_HOME/pg/pg_service.conf"

# Python
export PYTHON_EGG_CACHE="$XDG_CACHE_HOME"/python-eggs
export PYLINTHOME="$XDG_CACHE_HOME"/pylint
export WORKON_HOME="$XDG_DATA_HOME/virtualenvs"

# Redis
export REDISCLI_HISTFILE="$XDG_DATA_HOME"/redis/rediscli_history
export REDISCLI_RCFILE="$XDG_CONFIG_HOME"/redis/redisclirc

# Rustup
export RUSTUP_HOME="$XDG_DATA_HOME"/rustup 

# Screen
export SCREENRC="$XDG_CONFIG_HOME"/screen/screenrc

# SQLite
export SQLITE_HISTORY=$XDG_DATA_HOME/sqlite_history

# Stack (Haskell)
export STACK_ROOT="$XDG_DATA_HOME"/stack

# Subversion
export SUBVERSION_HOME=$XDG_CONFIG_HOME/subversion

# Vagrant
export VAGRANT_HOME="$XDG_DATA_HOME"/vagrant
export VAGRANT_ALIAS_FILE="$XDG_DATA_HOME"/vagrant/aliases

# VSCode
export VSCODE_PORTABLE="$XDG_DATA_HOME"/vscode

# Wayland Settings
if [ -n "$WAYLAND_DISPLAY" ]; then
    export QT_WAYLAND_DISABLE_WINDOWDECORATION="1"
    export QT_WAYLAND_FORCE_DPI=96
    export QT_QPA_PLATFORMTHEME="qt5ct"
    export QT_QPA_PLATFORM=wayland
    export _JAVA_OPTIONS="-Dawt.useSystemAAFontSettings=on -Dswing.aatext=true -Dswing.defaultlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel -Dswing.crossplatformlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel ${_JAVA_OPTIONS}"
    export _JAVA_AWT_WM_NONREPARENTING=1
    export NO_AT_BRIDGE=1
    export BEMENU_BACKEND=wayland
    export $(gnome-keyring-daemon --start --components=pkcs11,secrets,ssh)
fi
